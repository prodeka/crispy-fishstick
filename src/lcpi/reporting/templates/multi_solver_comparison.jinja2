<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparaison Multi-Solveurs - {{ projet_metadata.nom_projet if projet_metadata else "Projet LCPI" }}</title>
    {% if inline_css %}
    <style>
    {{ inline_css }}
    </style>
    {% endif %}
    <style>
    /* Styles spécifiques pour le template multi-solveurs */
    :root {
        --bg: #0b0f13;
        --surface: #11161c;
        --surface-2: #161c23;
        --text: #e7edf4;
        --muted: #9db0c2;
        --brand: #4aa3ff;
        --ok: #21c55d;
        --ko: #ef4444;
        --border: #233041;
        --card-shadow: 0 1px 0 rgba(0,0,0,.25), 0 6px 20px rgba(0,0,0,.25);
        --radius: 10px;
        --epanet-color: #4aa3ff;
        --lcpi-color: #21c55d;
    }

    * {
        box-sizing: border-box;
    }

    html, body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font-family: Inter, Segoe UI, system-ui, Arial, sans-serif;
        line-height: 1.45;
    }

    .report-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 24px;
    }

    /* Header */
    .page-header {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: var(--card-shadow);
    }

    .header-content h1 {
        margin: 0 0 8px 0;
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--brand), var(--ok));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .header-content h2 {
        margin: 0 0 12px 0;
        font-weight: 500;
        color: var(--muted);
        font-size: 18px;
    }

    .meta-info {
        color: var(--muted);
        font-size: 14px;
    }

    /* Navigation */
    .toc {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 16px 20px;
        margin-bottom: 24px;
        box-shadow: var(--card-shadow);
    }

    .toc h3 {
        margin: 0 0 12px 0;
        color: var(--brand);
        font-size: 16px;
    }

    .toc ul {
        margin: 0;
        padding-left: 20px;
        list-style: none;
    }

    .toc li {
        margin-bottom: 6px;
    }

    .toc a {
        color: var(--text);
        text-decoration: none;
        padding: 4px 8px;
        border-radius: 6px;
        transition: all 0.2s ease;
    }

    .toc a:hover {
        background: var(--surface-2);
        color: var(--brand);
    }

    /* Sections */
    .section {
        margin-bottom: 32px;
    }

    .section h3 {
        margin: 0 0 20px 0;
        font-size: 24px;
        font-weight: 600;
        color: var(--text);
        border-bottom: 2px solid var(--border);
        padding-bottom: 8px;
    }

    /* Vue d'ensemble */
    .overview-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
        margin-bottom: 24px;
    }

    .overview-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--card-shadow);
    }

    .overview-card h4 {
        margin: 0 0 16px 0;
        font-size: 18px;
        font-weight: 600;
        color: var(--brand);
    }

    /* KPI Grid */
    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
    }

    .kpi-item {
        background: var(--surface-2);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 16px;
        text-align: center;
    }

    .kpi-label {
        font-size: 14px;
        color: var(--muted);
        margin-bottom: 8px;
        font-weight: 500;
    }

    .kpi-main {
        font-size: 24px;
        font-weight: 700;
        color: var(--text);
        margin-bottom: 4px;
    }

    .kpi-sub {
        font-size: 12px;
        color: var(--muted);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* Badges */
    .badge {
        display: inline-flex;
        align-items: center;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .badge-ok {
        background: rgba(33, 197, 93, 0.15);
        color: var(--ok);
        border: 1px solid rgba(33, 197, 93, 0.3);
    }

    .badge-ko {
        background: rgba(239, 68, 68, 0.15);
        color: var(--ko);
        border: 1px solid rgba(239, 68, 68, 0.3);
    }

    /* Comparaison des coûts */
    .cost-comparison {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .cost-bar {
        display: grid;
        grid-template-columns: 80px 1fr 120px;
        align-items: center;
        gap: 12px;
    }

    .cost-label {
        font-weight: 600;
        color: var(--text);
        font-size: 14px;
    }

    .cost-bar-container {
        height: 8px;
        background: var(--surface-2);
        border-radius: 4px;
        overflow: hidden;
    }

    .cost-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--epanet-color), var(--lcpi-color));
        border-radius: 4px;
        transition: width 0.3s ease;
    }

    .cost-value {
        font-weight: 600;
        color: var(--text);
        font-size: 14px;
        text-align: right;
    }

    /* Tableau de comparaison */
    .comparison-table-container {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: var(--card-shadow);
    }

    .comparison-table {
        width: 100%;
        border-collapse: collapse;
    }

    .comparison-table thead th {
        background: var(--surface-2);
        color: var(--text);
        font-weight: 600;
        text-align: left;
        padding: 16px;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
    }

    .comparison-table tbody td {
        padding: 16px;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
    }

    .comparison-table tbody tr:nth-child(odd) {
        background: rgba(255, 255, 255, 0.02);
    }

    .comparison-table tbody tr:hover {
        background: var(--surface-2);
    }

    .diff {
        font-weight: 600;
    }

    .diff-positive {
        color: var(--ok);
    }

    .diff-negative {
        color: var(--ko);
    }

    /* Sections par solveur */
    .solver-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
    }

    .solver-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--card-shadow);
    }

    .solver-card h4 {
        margin: 0 0 16px 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--brand);
    }

    /* Grilles de métadonnées et résultats */
    .meta-grid, .results-grid {
        display: grid;
        gap: 12px;
    }

    .meta-item, .result-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .meta-label, .result-label {
        color: var(--muted);
        font-size: 13px;
    }

    .meta-value, .result-value {
        color: var(--text);
        font-weight: 500;
        font-size: 13px;
    }

    /* Analyse hydraulique */
    .hydraulics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
    }

    .hydraulics-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--card-shadow);
    }

    .hydraulics-card h4 {
        margin: 0 0 16px 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--brand);
    }

    .pressure-chart {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .pressure-bar {
        display: grid;
        grid-template-columns: 120px 1fr 60px;
        align-items: center;
        gap: 12px;
    }

    .pressure-label {
        font-size: 12px;
        color: var(--muted);
        font-family: monospace;
    }

    .pressure-bar-container {
        height: 6px;
        background: var(--surface-2);
        border-radius: 3px;
        overflow: hidden;
    }

    .pressure-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--ko), var(--ok));
        border-radius: 3px;
    }

    .pressure-value {
        font-size: 12px;
        color: var(--text);
        font-weight: 500;
        text-align: right;
    }

    /* Analyse des diamètres */
    .diameters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
    }

    .diameters-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--card-shadow);
    }

    .diameters-card h4 {
        margin: 0 0 16px 0;
        font-size: 16px;
        font-weight: 600;
        color: var(--brand);
    }

    .diameter-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        margin-bottom: 16px;
    }

    .stat-item {
        text-align: center;
        padding: 12px;
        background: var(--surface-2);
        border-radius: 8px;
    }

    .stat-label {
        display: block;
        font-size: 11px;
        color: var(--muted);
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .stat-value {
        display: block;
        font-size: 16px;
        font-weight: 600;
        color: var(--text);
    }

    .diameter-distribution {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 8px;
    }

    .dia-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: var(--surface-2);
        border-radius: 6px;
        font-size: 12px;
    }

    .dia-size {
        color: var(--text);
        font-weight: 500;
    }

    .dia-count {
        color: var(--muted);
        font-size: 11px;
    }

    /* Messages d'absence de données */
    .no-data {
        color: var(--muted);
        font-style: italic;
        text-align: center;
        padding: 20px;
    }

    /* Footer */
    .page-footer {
        margin-top: 40px;
        padding: 20px;
        text-align: center;
        color: var(--muted);
        font-size: 14px;
        border-top: 1px solid var(--border);
    }

    /* Responsive */
    @media (max-width: 768px) {
        .report-container {
            padding: 16px;
        }
        
        .overview-cards {
            grid-template-columns: 1fr;
        }
        
        .kpi-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .solver-cards {
            grid-template-columns: 1fr;
        }
        
        .hydraulics-grid {
            grid-template-columns: 1fr;
        }
        
        .diameters-grid {
            grid-template-columns: 1fr;
        }
        
        .cost-bar {
            grid-template-columns: 1fr;
            gap: 8px;
        }
        
        .cost-label {
            text-align: center;
        }
        
        .cost-value {
            text-align: center;
        }
        
        .comparison-table {
            font-size: 12px;
        }
        
        .comparison-table thead th,
        .comparison-table tbody td {
            padding: 8px;
        }
        
        .diameter-stats {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 480px) {
        .kpi-grid {
            grid-template-columns: 1fr;
        }
        
        .pressure-bar {
            grid-template-columns: 1fr;
            gap: 4px;
        }
        
        .pressure-label {
            text-align: center;
        }
        
        .pressure-value {
            text-align: center;
        }
    }
    </style>
</head>
<body>
    <div class="report-container">
        <header class="page-header">
            <div class="header-content">
                <h1>Comparaison Multi-Solveurs</h1>
                <h2>{{ projet_metadata.nom_projet if projet_metadata else "Projet LCPI" }}</h2>
                <div class="meta-info">
                    {% if projet_metadata.client %}Client: {{ projet_metadata.client }} · {% endif %}
                    Généré le {{ generation_date }} · LCPI v{{ version_lcpi }}
                </div>
            </div>
        </header>

        <nav class="toc">
            <h3>Sommaire</h3>
            <ul>
                <li><a href="#overview">Vue d'ensemble</a></li>
                <li><a href="#comparison">Comparaison détaillée</a></li>
                {% for solver in solvers %}
                <li><a href="#solver-{{ solver }}">{{ solver|upper }}</a></li>
                {% endfor %}
                <li><a href="#hydraulics">Analyse hydraulique</a></li>
                <li><a href="#diameters">Analyse des diamètres</a></li>
            </ul>
        </nav>

        <main>
            <!-- Vue d'ensemble -->
            <section id="overview" class="section">
                <h3>Vue d'ensemble</h3>
                <div class="overview-cards">
                    <div class="overview-card">
                        <h4>Résumé global</h4>
                        <div class="kpi-grid">
                            {% for solver in solvers %}
                            {% set data = solver_data[solver] %}
                            {% set best = data.proposals[0] if data.proposals else {} %}
                            <div class="kpi-item">
                                <div class="kpi-label">{{ solver|upper }}</div>
                                <div class="kpi-value">
                                    <div class="kpi-main">{{ '%.0f'|format(best.CAPEX) if best.CAPEX else '—' }} FCFA</div>
                                    <div class="kpi-sub">
                                        {% if best.constraints_ok %}
                                        <span class="badge badge-ok">OK</span>
                                        {% else %}
                                        <span class="badge badge-ko">KO</span>
                                        {% endif %}
                                        Pmin: {{ '%.1f'|format(best.min_pressure_m) if best.min_pressure_m else '—' }}m
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="overview-card">
                        <h4>Comparaison des coûts</h4>
                        <div class="cost-comparison">
                            {% set costs = [] %}
                            {% for solver in solvers %}
                                {% set data = solver_data[solver] %}
                                {% set best = data.proposals[0] if data.proposals else {} %}
                                {% set _ = costs.append(best.CAPEX or 0) %}
                            {% endfor %}
                            {% set min_cost = costs|min if costs else 0 %}
                            {% set max_cost = costs|max if costs else 0 %}
                            
                            {% for solver in solvers %}
                            {% set data = solver_data[solver] %}
                            {% set best = data.proposals[0] if data.proposals else {} %}
                            {% set cost = best.CAPEX or 0 %}
                            {% set percentage = ((cost - min_cost) / (max_cost - min_cost) * 100) if max_cost > min_cost else 0 %}
                            <div class="cost-bar">
                                <div class="cost-label">{{ solver|upper }}</div>
                                <div class="cost-bar-container">
                                    <div class="cost-bar-fill" style="width: {{ percentage }}%"></div>
                                </div>
                                <div class="cost-value">{{ '%.0f'|format(cost) }} FCFA</div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </section>

            <!-- Comparaison détaillée -->
            <section id="comparison" class="section">
                <h3>Comparaison détaillée</h3>
                <div class="comparison-table-container">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Métrique</th>
                                {% for solver in solvers %}
                                <th>{{ solver|upper }}</th>
                                {% endfor %}
                                <th>Différence</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set epanet_data = solver_data['epanet'] %}
                            {% set lcpi_data = solver_data['lcpi'] %}
                            {% set epanet_best = epanet_data.proposals[0] if epanet_data.proposals else {} %}
                            {% set lcpi_best = lcpi_data.proposals[0] if lcpi_data.proposals else {} %}
                            
                            <tr>
                                <td>CAPEX (FCFA)</td>
                                <td>{{ '%.0f'|format(epanet_best.CAPEX) if epanet_best.CAPEX else '—' }}</td>
                                <td>{{ '%.0f'|format(lcpi_best.CAPEX) if lcpi_best.CAPEX else '—' }}</td>
                                <td class="diff">
                                    {% if epanet_best.CAPEX and lcpi_best.CAPEX %}
                                        {% set diff = lcpi_best.CAPEX - epanet_best.CAPEX %}
                                        {% set pct = (diff / epanet_best.CAPEX * 100) %}
                                        <span class="{% if diff > 0 %}diff-positive{% else %}diff-negative{% endif %}">
                                            {{ '%.1f'|format(pct) }}%
                                        </span>
                                    {% else %}
                                        —
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td>Pression min (m)</td>
                                <td>{{ '%.3f'|format(epanet_best.min_pressure_m) if epanet_best.min_pressure_m else '—' }}</td>
                                <td>{{ '%.3f'|format(lcpi_best.min_pressure_m) if lcpi_best.min_pressure_m else '—' }}</td>
                                <td class="diff">
                                    {% if epanet_best.min_pressure_m and lcpi_best.min_pressure_m %}
                                        {% set diff = lcpi_best.min_pressure_m - epanet_best.min_pressure_m %}
                                        <span class="{% if diff > 0 %}diff-positive{% else %}diff-negative{% endif %}">
                                            {{ '%.3f'|format(diff) }}m
                                        </span>
                                    {% else %}
                                        —
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td>Vitesse max (m/s)</td>
                                <td>{{ '%.3f'|format(epanet_best.max_velocity_m_s) if epanet_best.max_velocity_m_s else '—' }}</td>
                                <td>{{ '%.3f'|format(lcpi_best.max_velocity_m_s) if lcpi_best.max_velocity_m_s else '—' }}</td>
                                <td class="diff">
                                    {% if epanet_best.max_velocity_m_s and lcpi_best.max_velocity_m_s %}
                                        {% set diff = lcpi_best.max_velocity_m_s - epanet_best.max_velocity_m_s %}
                                        <span class="{% if diff < 0 %}diff-positive{% else %}diff-negative{% endif %}">
                                            {{ '%.3f'|format(diff) }}m/s
                                        </span>
                                    {% else %}
                                        —
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td>Contraintes OK</td>
                                <td>
                                    <span class="badge {% if epanet_best.constraints_ok %}badge-ok{% else %}badge-ko{% endif %}">
                                        {{ 'Oui' if epanet_best.constraints_ok else 'Non' }}
                                    </span>
                                </td>
                                <td>
                                    <span class="badge {% if lcpi_best.constraints_ok %}badge-ok{% else %}badge-ko{% endif %}">
                                        {{ 'Oui' if lcpi_best.constraints_ok else 'Non' }}
                                    </span>
                                </td>
                                <td>—</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Sections par solveur -->
            {% for solver in solvers %}
            {% set data = solver_data[solver] %}
            <section id="solver-{{ solver }}" class="section">
                <h3>{{ solver|upper }}</h3>
                
                <div class="solver-cards">
                    <div class="solver-card">
                        <h4>Métadonnées</h4>
                        <div class="meta-grid">
                            <div class="meta-item">
                                <span class="meta-label">Fichier réseau</span>
                                <span class="meta-value">{{ data.meta.source_meta.file if data.meta.source_meta else '—' }}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Méthode</span>
                                <span class="meta-value">{{ data.meta.method or '—' }}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Contraintes</span>
                                <span class="meta-value">
                                    Pmin: {{ data.meta.constraints.pressure_min_m or '—' }}m ·
                                    Vmax: {{ data.meta.constraints.velocity_max_m_s or '—' }}m/s
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="solver-card">
                        <h4>Résultats</h4>
                        {% if data.proposals %}
                        {% set best = data.proposals[0] %}
                        <div class="results-grid">
                            <div class="result-item">
                                <span class="result-label">CAPEX</span>
                                <span class="result-value">{{ '%.0f'|format(best.CAPEX) if best.CAPEX else '—' }} FCFA</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Pression min</span>
                                <span class="result-value">{{ '%.3f'|format(best.min_pressure_m) if best.min_pressure_m else '—' }} m</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Vitesse max</span>
                                <span class="result-value">{{ '%.3f'|format(best.max_velocity_m_s) if best.max_velocity_m_s else '—' }} m/s</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Statut</span>
                                <span class="result-value">
                                    <span class="badge {% if best.constraints_ok %}badge-ok{% else %}badge-ko{% endif %}">
                                        {{ 'OK' if best.constraints_ok else 'KO' }}
                                    </span>
                                </span>
                            </div>
                        </div>
                        {% else %}
                        <p class="no-data">Aucune proposition disponible</p>
                        {% endif %}
                    </div>
                </div>
            </section>
            {% endfor %}

            <!-- Analyse hydraulique -->
            <section id="hydraulics" class="section">
                <h3>Analyse hydraulique</h3>
                <div class="hydraulics-grid">
                    {% for solver in solvers %}
                    {% set data = solver_data[solver] %}
                    {% set hyd = data.hydraulics if data.hydraulics else {} %}
                    {% set pressures = hyd.pressures_m if hyd.pressures_m else (hyd.pressures if hyd.pressures else {}) %}
                    {% set velocities = hyd.velocities_m_s if hyd.velocities_m_s else (hyd.velocities if hyd.velocities else {}) %}
                    
                    <div class="hydraulics-card">
                        <h4>{{ solver|upper }} - Pressions</h4>
                        {% if pressures %}
                            {% set pres_sorted = pressures|dictsort(by='value') %}
                            <div class="pressure-chart">
                                {% for k, v in pres_sorted[:10] %}
                                <div class="pressure-bar">
                                    <div class="pressure-label">{{ k }}</div>
                                    <div class="pressure-bar-container">
                                        <div class="pressure-bar-fill" style="width: {{ (v / 80 * 100)|round(1) }}%"></div>
                                    </div>
                                    <div class="pressure-value">{{ '%.1f'|format(v) }}m</div>
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="no-data">Aucune donnée de pression</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </section>

            <!-- Analyse des diamètres -->
            <section id="diameters" class="section">
                <h3>Analyse des diamètres</h3>
                <div class="diameters-grid">
                    {% for solver in solvers %}
                    {% set data = solver_data[solver] %}
                    {% set best = data.proposals[0] if data.proposals else {} %}
                    {% set diameters = best.diameters_mm if best.diameters_mm else {} %}
                    
                    <div class="diameters-card">
                        <h4>{{ solver|upper }} - Distribution des diamètres</h4>
                        {% if diameters %}
                            {% set dia_sorted = diameters|dictsort(by='value', reverse=True) %}
                            <div class="diameter-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Diamètre min</span>
                                    <span class="stat-value">{{ dia_sorted[-1][1] if dia_sorted else '—' }} mm</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Diamètre max</span>
                                    <span class="stat-value">{{ dia_sorted[0][1] if dia_sorted else '—' }} mm</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Moyenne</span>
                                    <span class="stat-value">
                                        {{ '%.0f'|format(diameters.values()|sum / diameters|length) if diameters else '—' }} mm
                                    </span>
                                </div>
                            </div>
                            <div class="diameter-distribution">
                                {% set dia_counts = {} %}
                                {% for k, v in diameters.items() %}
                                    {% set _ = dia_counts.update({v: (dia_counts.get(v, 0) + 1)}) %}
                                {% endfor %}
                                {% for dia, count in dia_counts|dictsort(by='key') %}
                                <div class="dia-item">
                                    <span class="dia-size">{{ dia }}mm</span>
                                    <span class="dia-count">{{ count }}</span>
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="no-data">Aucun diamètre disponible</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </section>
        </main>

        <footer class="page-footer">
            <p>Rapport généré le {{ generation_date }} — LCPI v{{ version_lcpi }}</p>
        </footer>
    </div>
</body>
</html>
